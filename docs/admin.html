<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ê–¥–º–∏–Ω–∫–∞ ‚Äî –∑–∞–∫–∞–∑—ã</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f9f9f9;
    }
    h1 {
      margin-bottom: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    th, td {
      padding: 12px;
      border: 1px solid #ddd;
      text-align: left;
    }
    th {
      background: #2d89ef;
      color: #fff;
    }
    tr:nth-child(even) {
      background: #f3f6fa;
    }
    #login {
      text-align: center;
      margin-top: 100px;
    }
    #login input {
      padding: 10px;
      font-size: 16px;
    }
    #login button {
      padding: 10px 20px;
      font-size: 16px;
      margin-left: 5px;
    }
  </style>
</head>
<body>
  <h1>–ê–¥–º–∏–Ω–∫–∞</h1>

  <!-- –ë–ª–æ–∫ –¥–ª—è –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è -->
  <div id="login">
    <p>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞:</p>
    <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å">
    <button onclick="checkPassword()">–í–æ–π—Ç–∏</button>
    <p id="error" style="color:red;"></p>
  </div>

  <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç–∞) -->
  <div id="ordersSection" style="display:none;">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>–¢–æ–≤–∞—Ä</th>
          <th>–¶–µ–Ω–∞</th>
          <th>–ò–º—è</th>
          <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
          <th>–î–∞—Ç–∞</th>
        </tr>
      </thead>
      <tbody id="orders">
        <tr><td colspan="6">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
      </tbody>
    </table>
  </div>

  <script>
    const BACKEND_URL = "https://my-shop-production.up.railway.app";
    const ADMIN_PASSWORD = "0567"; // üõë –ó–∞–¥–∞–π —Å–≤–æ–π –ø–∞—Ä–æ–ª—å!

    function checkPassword() {
      const input = document.getElementById("password").value;
      if (input === ADMIN_PASSWORD) {
        document.getElementById("login").style.display = "none";
        document.getElementById("ordersSection").style.display = "block";
        loadOrders();
      } else {
        document.getElementById("error").innerText = "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!";
      }
    }

    async function loadOrders() {
      try {
        const res = await fetch(BACKEND_URL + "/orders");
        const orders = await res.json();

        const tbody = document.getElementById("orders");
        if (orders.length === 0) {
          tbody.innerHTML = "<tr><td colspan='6'>–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</td></tr>";
          return;
        }

        tbody.innerHTML = orders.map(o => `
          <tr>
            <td>${o.id}</td>
            <td>${o.product_name}</td>
            <td>${o.price} ‚ÇΩ</td>
            <td>${o.customer_name}</td>
            <td>${o.customer_phone}</td>
            <td>${new Date(o.created_at).toLocaleString()}</td>
          </tr>
        `).join("");
      } catch (err) {
        console.error(err);
        document.getElementById("orders").innerHTML =
          "<tr><td colspan='6'>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤</td></tr>";
      }
    }
  </script>
</body>
</html>
